import{u as j,b as f,a5 as g,r as i,m as C,cq as u,j as a,B as o,cr as v,bX as N,b5 as D,bZ as T,L as y,d as B,aX as S,bE as k,aU as E,aY as M,aZ as A,a_ as H,a$ as I,X as L,b0 as O,bk as $,cs as P,v as R,bv as X,bw as z,ct as V,by as Z,cj as _,cu as q,cv as F,J,K,O as U,P as Y}from"./index.9642abf5.js";import{T as G,a as Q,b as w,e as l,d as W,c as d}from"./table.3bc0dcc0.js";function aa(s){const{t:e}=j(),{toast:n}=B(),[t,r]=i.useState(!1),[c,x]=i.useState("");async function m(){var b;const h=c.trim();if(h.length===0)return;const p=await F(h);p.status?(n({title:e("admin.post-success"),description:e("admin.post-success-prompt")}),x(""),r(!1),(b=s.onCreated)==null||b.call(s)):n({title:e("admin.post-failed"),description:e("admin.post-failed-prompt",{reason:p.error})})}return a.jsxs(S,{open:t,onOpenChange:r,children:[a.jsx(k,{asChild:!0,children:a.jsxs(o,{variant:"default",children:[a.jsx(E,{className:"w-4 h-4 mr-1"}),e("admin.create-broadcast")]})}),a.jsxs(M,{children:[a.jsxs(A,{children:[a.jsx(H,{children:e("admin.create-broadcast")}),a.jsx(I,{asChild:!0,children:a.jsx("div",{className:"pt-4",children:a.jsx(L,{placeholder:e("admin.broadcast-placeholder"),value:c,rows:5,onChange:h=>x(h.target.value)})})})]}),a.jsxs(O,{children:[a.jsx($,{asChild:!0,children:a.jsx(o,{variant:"outline",children:e("admin.cancel")})}),a.jsx(o,{variant:"default",onClick:m,loading:!0,children:e("admin.post")})]})]})]})}function sa({item:s}){const{t:e}=j(),[n,t]=i.useState(!1),[r,c]=i.useState("");return a.jsxs(w,{children:[a.jsx(P,{title:e("admin.view"),value:r||s.content,onChange:c,open:n,setOpen:t}),a.jsx(d,{children:s.index}),a.jsx(d,{children:R(s.content,25)}),a.jsx(d,{children:s.poster}),a.jsx(d,{children:s.created_at}),a.jsx(d,{children:a.jsxs(X,{children:[a.jsx(z,{asChild:!0,children:a.jsx(o,{variant:"outline",size:"icon",children:a.jsx(V,{className:"w-4 h-4"})})}),a.jsx(Z,{align:"end",children:a.jsxs(_,{onClick:()=>t(!0),children:[a.jsx(q,{className:"w-4 h-4 mr-1"}),e("admin.view")]})})]})})]})}function ea(){const{t:s}=j(),e=f(g),[n,t]=i.useState([]),[r,c]=i.useState(!1);return C(async()=>{e&&(c(!0),t(await u()),c(!1))},[e]),a.jsxs("div",{className:"broadcast-table whitespace-nowrap",children:[a.jsxs("div",{className:"broadcast-action flex flex-row flex-nowrap w-full mb-4",children:[a.jsx(o,{variant:"outline",size:"icon",className:"select-none",onClick:async()=>{t(await u())},children:a.jsx(v,{className:"w-4 h-4"})}),a.jsx("div",{className:"grow"}),a.jsx(aa,{onCreated:async()=>t(await u())})]}),a.jsxs(N,{className:"pb-2 mb-4",children:[a.jsx(D,{className:"h-4 w-4"}),a.jsx(T,{className:"break-all whitespace-pre-wrap",children:s("admin.broadcast-tip")})]}),n.length?a.jsxs(G,{children:[a.jsx(Q,{children:a.jsxs(w,{className:"select-none whitespace-nowrap",children:[a.jsx(l,{children:"ID"}),a.jsx(l,{children:s("admin.broadcast-content")}),a.jsx(l,{children:s("admin.poster")}),a.jsx(l,{children:s("admin.post-at")}),a.jsx(l,{children:s("admin.action")})]})}),a.jsx(W,{children:n.map((x,m)=>a.jsx(sa,{item:x},m))})]}):a.jsx("div",{className:"text-center select-none my-8",children:r?a.jsx(y,{className:"w-6 h-6 inline-block animate-spin"}):a.jsx("p",{className:"empty",children:s("admin.empty")})})]})}function ca(){const{t:s}=j();return a.jsx("div",{className:"broadcast",children:a.jsxs(J,{className:"admin-card broadcast-card",children:[a.jsx(K,{className:"select-none",children:a.jsx(U,{children:s("admin.broadcast")})}),a.jsx(Y,{children:a.jsx(ea,{})})]})})}export{ca as default};
