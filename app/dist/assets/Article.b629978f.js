import{c as D,$ as G,r as l,G as E,_,j as a,n as M,B as m,a as W,C as z,u as w,J as H,K as J,O as X,P as B,Q,d as U,b as k,R as K,s as Y,f as S,T as Z,U as ee,V as ae,W as te,X as y,M as se,Y as re,L as ne,e as le,w as oe,g as ce,t as ie}from"./index.9642abf5.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=D("Files",[["path",{d:"M15.5 2H8.6c-.4 0-.8.2-1.1.5-.3.3-.5.7-.5 1.1v12.8c0 .4.2.8.5 1.1.3.3.7.5 1.1.5h9.8c.4 0 .8-.2 1.1-.5.3-.3.5-.7.5-1.1V6.5L15.5 2z",key:"cennsq"}],["path",{d:"M3 7.6v12.8c0 .4.2.8.5 1.1.3.3.7.5 1.1.5h9.8",key:"ms809a"}],["path",{d:"M15 2v5h5",key:"qq6kwv"}]]);const V="Progress",h=100,[ue,Pe]=G(V),[me,pe]=ue(V),L=l.forwardRef((e,t)=>{const{__scopeProgress:r,value:s,max:i,getValueLabel:o=$e,...p}=e,d=b(i)?i:h,n=F(s,d)?s:null,x=$(n)?o(n,d):void 0;return l.createElement(me,{scope:r,value:n,max:d},l.createElement(E.div,_({"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":$(n)?n:void 0,"aria-valuetext":x,role:"progressbar","data-state":T(n,d),"data-value":n??void 0,"data-max":d},p,{ref:t})))});L.propTypes={max(e,t,r){const s=e[t],i=String(s);return s&&!b(s)?new Error(he(i,r)):null},value(e,t,r){const s=e[t],i=String(s),o=b(e.max)?e.max:h;return s!=null&&!F(s,o)?new Error(ve(i,r)):null}};const xe="ProgressIndicator",fe=l.forwardRef((e,t)=>{var r;const{__scopeProgress:s,...i}=e,o=pe(xe,s);return l.createElement(E.div,_({"data-state":T(o.value,o.max),"data-value":(r=o.value)!==null&&r!==void 0?r:void 0,"data-max":o.max},i,{ref:t}))});function $e(e,t){return`${Math.round(e/t*100)}%`}function T(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function $(e){return typeof e=="number"}function b(e){return $(e)&&!isNaN(e)&&e>0}function F(e,t){return $(e)&&!isNaN(e)&&e<=t&&e>=0}function he(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${h}\`.`}function ve(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${h} if no \`max\` prop is set)
  - \`null\` if the progress is indeterminate.

Defaulting to \`null\`.`}const I=L,ge=fe,R=l.forwardRef(({className:e,value:t,...r},s)=>a.jsx(I,{ref:s,className:M("relative h-4 w-full overflow-hidden rounded-full bg-muted",e),...r,children:a.jsx(ge,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));R.displayName=I.displayName;function be({current:e,total:t,quota:r}){const{t:s}=w();return a.jsxs("div",{className:"article-progress w-full mb-4",children:[a.jsx("p",{className:"select-none mt-4 mb-2.5 flex flex-row items-center content-center w-full justify-center text-center",children:t!==0&&e===t?a.jsxs(a.Fragment,{children:[a.jsx(re,{className:"h-5 w-5 mr-2 inline-block animate-out shrink-0"}),s("article.generate-success")]}):a.jsxs(a.Fragment,{children:[a.jsx(ne,{className:"h-5 w-5 mr-2 inline-block animate-spin shrink-0"}),s("article.progress-title",{current:e,total:t})]})}),a.jsx(R,{value:100*e/t}),a.jsxs("div",{className:"article-quota flex flex-row mt-4 border border-input rounded-md py-1 px-3 select-none w-max items-center mx-auto",children:[a.jsx(le,{className:"h-4 w-4 mr-2"}),a.jsx("p",{children:r.toFixed(2)})]})]})}function we(){const{t:e}=w(),t=Q(),{toast:r}=U(),s=k(K),i=k(Y),[o,p]=l.useState(""),[d,n]=l.useState(""),[x,v]=l.useState(!1),[q,j]=l.useState({current:0,total:0}),[N,P]=l.useState(0),[g,C]=l.useState("");function A(){p(""),n(""),C(""),v(!1),P(0),j({current:0,total:0})}function O(){v(!0);const c=new WebSocket(`${oe}/article/create`);c.onopen=()=>{c.send(JSON.stringify({token:ce(ie),web:s,title:d,prompt:o,model:i}))},c.onmessage=f=>{const u=JSON.parse(f.data);u.data&&u.data.quota&&P(N+u.data.quota),u.hash?(r({title:e("article.generate-success"),description:e("article.generate-success-prompt")}),C(u.hash)):j(u.data)},c.onerror=f=>{console.debug(`[article] error during generation: ${f}`),r({title:e("article.generate-failed"),description:`${e("article.generate-failed-prompt")} (${f.toString()})`}),v(!1),c.close()}}return x?a.jsxs(a.Fragment,{children:[a.jsx(be,{...q,quota:N}),g&&a.jsxs("div",{className:"article-action flex flex-row items-center my-4 gap-4",children:[a.jsxs(m,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${S}/article/download/zip?hash=${g}`},children:[" ",e("article.download-format",{name:"zip"})," "]}),a.jsxs(m,{variant:"outline",className:"w-full whitespace-nowrap",onClick:()=>{location.href=`${S}/article/download/tar?hash=${g}`},children:[" ",e("article.download-format",{name:"tar"})," "]})]}),a.jsx(m,{variant:"default",className:"mt-5 w-full mx-auto",onClick:A,children:e("close")})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-row items-center mx-auto",children:[a.jsx(Z,{"aria-label":e("chat.web-aria"),defaultPressed:!1,onPressedChange:c=>t(ee(c)),variant:"outline",children:a.jsx(ae,{className:M("h-4 w-4 web",s&&"enable")})}),a.jsx(te,{className:"ml-2.5 whitespace-nowrap",children:e("article.web-checkbox")})]}),a.jsx(y,{placeholder:e("article.prompt-placeholder"),rows:3,value:o,onChange:c=>p(c.target.value)}),a.jsx(y,{placeholder:e("article.input-placeholder"),rows:8,value:d,onChange:c=>n(c.target.value)}),a.jsx(se,{side:"bottom"}),a.jsx(m,{variant:"default",className:"mt-5 w-full mx-auto",onClick:O,disabled:x||!d,children:e("article.generate")})]})}function je(){const{t:e}=w();return a.jsxs(H,{className:"article-wrapper",children:[a.jsx(J,{className:"py-4",children:a.jsxs(X,{className:"article-title",children:[a.jsx(de,{className:"h-5 w-5 mr-2"}),e("article.title")]})}),a.jsx(B,{className:"article-content",children:a.jsx(we,{})})]})}function Ce(){return a.jsx("div",{className:"article-page",children:a.jsxs("div",{className:"article-container",children:[a.jsx(m,{className:"action",variant:"ghost",size:"icon",onClick:()=>W.navigate("/"),children:a.jsx(z,{className:"h-5 w-5 back"})}),a.jsx(je,{})]})})}export{Ce as default};
